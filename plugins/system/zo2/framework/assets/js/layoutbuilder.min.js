(function(w,z,$){var _layoutbuilder={_elements:{layoutBuilderContainer:'#layoutbuilder-container > #zo2-layoutbuilder',childrenContainer:'.children-container',sortableConnect:'.connectedSortable',sortableRow:'.sortable-row',joomlaTooltip:'.tooltip'},layoutJson:null,_init:function(){var _self=this;$(_self._elements.childrenContainer).sortable({placeholder:"sortable-hightligth",start:function(event,ui){ui.placeholder.height(ui.helper.outerHeight());ui.placeholder.addClass(ui.item.attr('class'));},stop:function(event,ui){ui.placeholder.removeClass(ui.item.attr('class'));},connectWith:_self._elements.sortableConnect}).disableSelection();$(_self._elements.layoutBuilderContainer).sortable({placeholder:"sortable-hightligth",start:function(event,ui){ui.placeholder.height(ui.helper.outerHeight());ui.placeholder.addClass(ui.item.attr('class'));},stop:function(event,ui){ui.placeholder.removeClass(ui.item.attr('class'));}}).disableSelection();},sortableFlush:function(){$(this._elements.layoutBuilderContainer).sortable("destroy");$(this._elements.childrenContainer).sortable("destroy");},getLayoutJson:function(){this.layoutJson=[];this._getLayoutJson();return this.layoutJson;},addParentRow:function(){var html='';this.sortableFlush();html+='<div class="sortable-row  col-xs-12 col-sm-12 col-md-12 col-lg-12 row-parent" id="" data-zo2="{&quot;name&quot;:&quot;&quot;}">';html+='<div class="row-control">';html+='<div class="parent-container clearfix row">';html+='<div class="row-size">';html+='<a title="Decrease width" href="#" class="row-decrease"><i data-original-title="Decrease width" class="hasTooltip fa fa-angle-double-left"></i></a>';html+='<span class="column_size">1/1</span>';html+='<a title="Increase width" href="#" class="row-increase"><i data-original-title="Increase width" class="hasTooltip fa fa-angle-double-right"></i></a>';html+='</div>';html+='<div class="row-name">';html+='<span>(none)</span>';html+='</div>';html+='<div class="row-controls">';html+='<i title="" class="fa fa-plus row-control-icon add-row hasTooltip" data-original-title="addRow"></i>';html+='<i title="" class="fa fa-cog row-control-icon settings hasTooltip" data-original-title="settings"></i>';html+='<i title="" class="row-control-icon delete fa fa-remove hasTooltip" data-original-title="remove"></i>';html+='</div>';html+='</div>';html+='<div class="children-container row sortable-row connectedSortable ui-sortable">';html+='</div>';html+='</div>';html+='</div>';$(this._elements.layoutBuilderContainer).find(this._elements.sortableRow+':first').before(html);this._init();},addRow:function(element){var html='';this.sortableFlush();html+='<div class="sortable-row  col-xs-12 col-sm-12 col-md-12 col-lg-12 row-child" id="" data-zo2="{&quot;name&quot;:&quot;&quot;,&quot;grid&quot;:{&quot;xs&quot;:12,&quot;sm&quot;:12,&quot;md&quot;:12,&quot;lg&quot;:12}}">';html+='<div class="row-control">';html+='<div class="parent-container clearfix row">';html+='<div class="row-size">';html+='<a title="Decrease width" href="#" class="row-decrease"><i data-original-title="Decrease width" class="hasTooltip fa fa-angle-double-left"></i></a>';html+='<span class="column_size">12/12</span>';html+='<a title="Increase width" href="#" class="row-increase"><i data-original-title="Increase width" class="hasTooltip fa fa-angle-double-right"></i></a>';html+='</div>';html+='<div class="row-name">';html+='<span>(none)</span>';html+='</div>';html+='<div class="row-controls">';html+='<i title="" class="fa fa-plus row-control-icon add-row hasTooltip" onclick="zo2.layoutbuilder.addRow(this);" data-original-title="addRow"></i>';html+='<i title="" class="fa fa-cog row-control-icon settings hasTooltip" data-original-title="settings"></i>';html+='<i title="" class="row-control-icon delete fa fa-remove hasTooltip" data-original-title="remove"></i>';html+='</div>';html+='</div>';html+='<div class="children-container row sortable-row connectedSortable ui-sortable">';html+='</div>';html+='</div>';html+='</div>';var $childContainer=$(element).closest(this._elements.sortableRow).find(this._elements.childrenContainer+':first');if($childContainer.find(this._elements.sortableRow).length>0){$childContainer.find(this._elements.sortableRow+':first').before(html);}else{$childContainer.html(html);}
this._init();},deleteRow:function(element){$(element).closest(this._elements.sortableRow).remove();$(this._elements.joomlaTooltip).find(':visible').hide();},_getLayoutJson:function($node,parent){var _self=this;if(typeof($node)=='undefined'){$node=$(_self._elements.layoutBuilderContainer);parent=_self.layoutJson;}else{$node=$node.find(_self._elements.childrenContainer+':first');}
$.each($node.children(_self._elements.sortableRow),function(){if(typeof($(this).data('zo2'))!='undefined'){parent.push($(this).data('zo2'));parent[parent.length-1].children=[];_self._getLayoutJson($(this),parent[parent.length-1].children);}});}};z.layoutbuilder=_layoutbuilder;$(w.document).ready(function(){z.layoutbuilder._init();});})(window,zo2,jQuery);